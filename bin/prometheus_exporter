#!/usr/bin/env ruby

require_relative "./../lib/prometheus_exporter"
require_relative "./../lib/prometheus_exporter/server"

def usage
  puts "Usage: prometheus_exporter PORT [--collector filename]"
end

port = ARGV[0].to_i

if port > 0
  puts "#{Time.now} Starting prometheus exporter on port #{port}"
  server = PrometheusExporter::Server::WebServer.new port: port
  server.start
  sleep
else
  usage
  exit 1
end
